<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Arbitrum Sepolia Counter DApp</title>
</head>
<body>
  <h1>Arbitrum Sepolia Counter DApp</h1>
  <button id="connect">连接 OKX 钱包</button>
  <button id="inc">增加 count</button>
  <button id="set">设置 count = 10</button>

  <p>当前 count: <span id="value">-</span></p>

  <script src="https://cdn.jsdelivr.net/npm/ethers@6.8.0/dist/ethers.min.js"></script>
  <script>
    const contractAddress = "0xb25EA940aCf9fe9d5097Aef885229944F8A06eA7";
    const abi = [
      "function count() view returns (uint256)",
      "function increment()",
      "function set(uint256 _v)"
    ];

    let provider, signer, contract;

    document.getElementById("connect").onclick = async () => {
      if (!window.ethereum) {
        alert("请先安装 OKX Web3 钱包插件");
        return;
      }
      await window.ethereum.request({ method: "eth_requestAccounts" });
      provider = new ethers.BrowserProvider(window.ethereum);
      signer = await provider.getSigner();
      contract = new ethers.Contract(contractAddress, abi, signer);
      alert("钱包已连接");
    };

    document.getElementById("inc").onclick = async () => {
      if (!contract) return alert("请先连接钱包");
      await contract.increment();
    };

    document.getElementById("set").onclick = async () => {
      if (!contract) return alert("请先连接钱包");
      await contract.set(10);
    };

    setInterval(async () => {
      if (contract) {
        document.getElementById("value").innerText = await contract.count();
      }
    }, 2000);
  </script>
</body>
</html>
